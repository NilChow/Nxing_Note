[TOC]

# 在线求助

### man page

| 代号 |                       代表内容                        |
| :--: | :---------------------------------------------------: |
|  1   |     使用者在shell环境中可以操作的命令或可运行文件     |
|  2   |             系统核心可调用的函数与工具等              |
|  3   |          一些常用的函数与函数库，大部分为C的          |
|  4   |          设备文件的说明，通常在/dev下的文件           |
|  5   |              配置文件或者某些文件的格式               |
|  6   |                         游戏                          |
|  7   | 惯例与协议等，例如Linux文件系统、网络协议、ASCII code |
|  8   |               系统管理员可用的管理命令                |
|  9   |                  跟kernel有关的文件                   |

### 相关操作

|      按键       |           效果            |
| :-------------: | :-----------------------: |
|  <kbd> </kbd>   |        向下翻一页         |
| <kbd>PgDn</kbd> |        向下翻一页         |
| <kbd>PgUp</kbd> |        向上翻一页         |
| <kbd>Home</kbd> |        跳到第一页         |
| <kbd>End</kbd>  |       跳到最后一页        |
|     /string     | 向下搜寻string这个字符串  |
|     ?string     | 向上搜寻string这个字符串  |
|       n/N       | 搜寻时，查找上一个/下一个 |
|        q        |       退出man page        |



# Linux文件、目录与磁盘格式

## Linux的文件权限与目录配置

### 使用者与群组

##### 文件拥有者

由于Linux是个多人多任务的系统，因此可能常常会有多人同时使用这部主机来进行工作的情况发生， 为了考虑每个人的隐私权以及每个人喜好的工作环境，因此，需要文件拥有者。

你可以将文件放在自己的目录下，并且指定文件拥有者为自己，那么别人就无法查看了。



##### 群组概念

我们可以添加用户到群组里面，然后设定群组的权限，那么群组里面的用户也拥有了该权限。



##### 其他人概念

其他人就是，即非文件拥有者，也不是所属群组的成员，就是毫无干系的用户。



##### 文件权限

至此，我们可以知道，在Linux系统中，任何一个文件都有 [**User**, **Group**, **Others**] 这三种身份的权限。



##### 相关系统文件 -- Linux用户身份与群组记录的文件

*   /etc/passwd：记录所有的系统上的账号和普通用户，还有root用户相关的信息
*   /etc/shadow：记录用户的密码
*   /etc/group：记录群组的信息



### 文件权限

![](..\0 - src\7\FilePermission.png)

连结：文件数量

##### 权限字段

在文件权限这一项，它总共有10个字符，**后面9个字符表示权限，第一个字符表示文件类型**

| 字符 |           含义           |
| :--: | :----------------------: |
|  d   |           目录           |
|  -   |           文件           |
|  l   |         链接文件         |
|  b   |       块设备(硬盘)       |
|  c   | 串行端口设备(鼠标、键盘) |

后面9个字符3个一组，总共3组，分别表示拥有者、群组、其他人的权限。

三个字符中，按rwx排序，分别表示读、写、执行权限。

*   r：4 -- **读**权限
*   w：2 -- **写**权限
*   x：1 -- **执行**权限



##### 修改文件所属群组 -- chgrp

命令：$ chgrp *group_name* *file_name*



##### 修改文件拥有者 -- chown

*   修改文件拥有者：$ chown *user_name* *file_name*
*   递归修改目录拥有者：$ chown -R *user_name* *dir_name*
*   同时修改拥有者和群组：$ chown *user_name*:*group_name* *file_name*



##### 修改文件权限

数字类型改变表示权限：

​		$ chmod 777 *file_name*

符号类型改变文件权限：

​		$ chmod u=rwx,go=rx  *file_name*

​		$ chmod a+x *file_name*

​		$ chmod x *file_name*

| 命令  | 指定对象 | 操作  | 权限类型 |   文件名    |
| :---: | :------: | :---: | :------: | :---------: |
| chmod | u/g/o/a  | +/-/= |  r/w/x   | *file_name* |

*   u：用户
*   g：用户组
*   o：其他人
*   a：all



### Linux的目录配置

##### Linux目录配置的依据 -- FHS

因为利用Linux来开发或维护的公司实在太多了，如果每个人都按照自己的想法来配置目录，那么势必会造成很多不方便和混乱。因此，就有了所谓的 Filesystem Hierarchy Standard(FHS) 标准！

FHS标准是希望让使用者了解到已安装软件通常安装于哪个目录下，并且规范了每个特定目录下应该要放置什么样子的文件以及数据。

|          |          可分享的          |       不可分享的       |
| :------: | :------------------------: | :--------------------: |
|  不变的  |      /usr (软件安装)       |    /etc (配置文件)     |
|          |   /opt (第三方协助软件)    | /boot (开机与核心文件) |
| 可变动的 | /var/mail (使用者邮件信箱) |  /var/run (程序相关)   |
|          |  /var/spool/news (新闻组)  |  /var/lock (程序相关)  |

事实上，FHS针对目录树架构仅定义出三层目录底下应该放置什么数据而已：

*   / (root，根目录)：与开机系统有关
*   /usr (unix software resource)：与软件安装/执行有关
*   /var (variable)：与系统操作过程有关



##### 根目录的意义与内容

根目录是整个系统中最重要的一个目录，因为所有的目录都是由根目录衍生出来的，并且根目录也与 开机/还原/系统修复 等动作有关。因此**根目录非常重要**，所以在FHS的要求方面，希望根目录不要放在非常大的分区内，因为分区越大，里面的数据越多，发生错误的几率就更大。

因此FHS建议，根目录所在分区应越小越好，且应用程序所安装的位置最好不要与根目录放在同一个分区内。

| 目录        | 应放置文件内容                                               |
| :---------- | :----------------------------------------------------------- |
| /bin        | 放置可以被root与一般账号所使用的执行文件的目录，如：cat、chmod等 |
| /boot       | 主要放置开机会使用到的文件，包括Linux核心文件以及开机选单与所需配置文件等 |
| /dev        | 任何硬件与接口设备都是以文件的形态存在于此目录中             |
| /etc        | 系统主要的配置文件几乎都在这个目录内 (用户的账户密码文件、各种服务的启动配置文件等，一般这个目录允许普通用户查看，但只有root有全力修改) |
| /home       | 系统默认的用户使用的目录                                     |
| /lib        | 放置开机时会用到的函数库，以及在/bin或/sbin目录下的指令会用到的函数库 |
| /media      | 放置可移除的设备，包括软盘、光盘、DVD等等                    |
| /mnt        | 与/media类似，用来放置暂时挂在某些额外的设备                 |
| /opt        | 放置第三方协力软件的目录                                     |
| /root       | 系统管理员的目录                                             |
| /sbin       | 开机过程中所需要的，包括开机、修复、还原系统所需要的指令     |
| /srv        | service的缩写，一些网络服务启动后，所需要取用的数据目录      |
| /tmp        | 用户或正在执行的程序暂时放置文件的目录。重要数据不要放在此目录，FHS建议开机时，删除/tmp下的数据 |
| /lost+found | 使用ext2/ext3文件系统格式才会产生的目录，当文件系统发生错误时，将一些遗失的片段放到此目录下 |
| /proc       | 这个目录本身是一个虚拟文件系统，它放置的数据都是在内存当中。例如：系统核心、进程信息、硬件状态以及网络状态等。因为这个目录下的数据都是在内存当中，所以本身不占任何硬盘空间。比较重要的文件：/proc/cpuinfo，/proc/dma，/proc/interrupts，/proc/ioports等 |
| sys         | 跟/proc类似，也是一个虚拟的文件系统，主要也是记录核心相关的信息。 |

以下目录要**与根目录在同一个分区**：

*   /etc：配置文件
*   /bin：重要执行文件
*   /dev：所需要的的设备文件
*   /lib：执行文件所需要得函数库与核心所需的模块
*   /sbin：重要的系统执行文件

这五个目录要与根目录在统一分区，因为开机过程中仅有根目录会被挂载，其它分区则是在开机完成后才会持续的来挂载。**因此，与开机过程相关的目录，就必须得和根目录在同一分区**。



##### /usr的意义与内容

根据FHS的定义，/usr里面放置的数据属于**可分享的**和**不可变动的**。

usr不是user的缩写，而是Unix Software Resource的缩写，意思就是【Unix操作系统软件资源】所在的目录，而不是用户数据，类似于Windows的C盘。

一般来说，/usr的子目录下建议有如下这些：

| 目录          | 对应文件内容                                                 |
| ------------- | ------------------------------------------------------------ |
| /usr/X11R6    | 为X Windows System重要数据所存放的目录，X11R6表示最后的X版本为11版，切该版本第6次发布 |
| /usr/bin/     | 大部分用户可使用的指令都放在这个目录下。请注意与/bin目录的区别(是否与开机过程相关) |
| /usr/include/ | C/C++等语言的头文件与include存放目录                         |
| /usr/lib/     | 包含各种软件的函数库，目标文件，以及不被一般用户惯用的执行文件或脚本(如果是X86_64的Linux系统，可能会有/usr/lib64/目录) |
| /usr/local/   | root用户下载的软件，建议安装到此目录，便于管理               |
| /usr/sbin/    | 非系统运行所需要的的系统指令                                 |
| /usr/share/   | 存放共享文件的目录，常见子目录：<br />-- /usr/share/man：联机帮助文件<br />-- /usr/share/doc：软件杂项的文件说明<br />-- /usr/share/zoneinfo：与时区有关的文件 |
| /usr/src/     | 一般源码建议放到此目录，至于核心源码则建议放在/usr/src/linux目录下 |



##### /var的意义与内容

**/usr是在安装时**会占用较大的硬盘容量的目录，而/**var是在系统运行后**才会逐渐占用硬盘容量的目录。

因为/var目录主要针对动态变动的文件，比如缓存(cache)，登录文件(log file)以及软件运行所产生的文件，包括程序文件(如lock file、run file)，或者数据库文件等。

常见子目录：

| 目录        | 对应文件内容                                                 |
| ----------- | ------------------------------------------------------------ |
| /var/cache/ | 程序本身运行过程中产生的缓存文件                             |
| /var/lib/   | 程序运行过程中，需用到的数据文件。应根据各程序创建子目录，如MySQL的数据库应放到/var/lib/mysql目录下，而rpm的数据应放到/var/lib/rpm目录下 |
| /var/lock/  | 某些设备或文件一次只能被一个程序使用，因此需要加锁(lock)     |
| /var/log/   | 非常重要！这是登录文件的目录，里面比较重要的文件如：/var/log/messages, /var/log/wtmp(记录登录用户的信息)等 |
| /var/mail/  | 个人电子邮箱，该目录也被放到/var/spool/mail目录中，一般这两个目录是互为链接文件的 |
| /var/run/   | 一些程序或者服务启动后，会将他们的进程号PID放在此目录下      |
| /var/spool/ | 一般存放一些队列数据                                         |







## Linux文件与目录管理

**特殊目录：**

| 目录  |          含义          |
| :---: | :--------------------: |
|   .   |         此目录         |
|  ..   |       上一层目录       |
|   -   |     上一个工作目录     |
|   ~   |   当前用户的home目录   |
| ~user | user这个用户的home目录 |



### 目录与路径

##### 创建目录 -- mkdir

*   mkdir *dirName*：创建目录
*   mkdir *dir1/dir2/dir3*：递归创建目录
*   mkdir -m 777 *dirName*：创建目录，并设置权限



##### 删除目录 -- rm、rmdir

*   rmdir *dirName*：删除空目录
*   rm -r *dirName*：删除目录及目录下所有子目录和文件
*   rmdir -p *dir1/dir2/dir3*：递归删除目录



##### 环境变量 -- $PATH

PATH(大写)这个环境变量的内容是由一堆目录组成的，每个目录中间用冒号(:)隔开，**被添加到环境变量中的目录，该目录下的命令可以在任何路径下运行**。







### 文件与目录管理

文件与目录的管理，无非就是 显示属性、拷贝、删除文件、移动文件或目录等。

##### 查看目录与文件 -- ls

| 参数选项 |                            含义                            |
| :------: | :--------------------------------------------------------: |
|    -a    |                 显示全部文件，包括隐藏文件                 |
|    -A    |   显示全部文件，包括隐藏文件，但不包括 .和.. 这两个目录    |
|    -h    |        文件大小以人类阅读的方式显示(例如：GB、KB等)        |
|    -l    | 显示更多数据信息，比如文件的属性与权限等数据(等同于ll命令) |
|    -r    |                     将排序结果反向显示                     |



##### 复制 -- cp

| 参数选项 |               含义               |
| :------: | :------------------------------: |
|    -i    |            覆盖前询问            |
|    -a    |  将创建时间、权限等属性一起复制  |
|    -r    |             复制目录             |
|    -l    |            创建硬链接            |
|    -s    |            创建软链接            |
|    -u    | 若源文件比目标文件新，才复制过来 |



##### 删除 -- rm

| 参数选项 |    含义    |
| :------: | :--------: |
|    -i    | 删除前询问 |







### 文件内容查看

Linux中有以下几种命令可以查看文件内容：

| 命令 |             功能              |
| :--: | :---------------------------: |
| cat  |   从第一行开始显示文件内容    |
| tac  | 从最后一行开始显示(cat倒着写) |
|  nl  |     显示的时候，输出行号      |
| more |    一页一页的显示文件内容     |
| less | 与more类似，但是可以向前翻页  |
| head |           只看头N行           |
| tail |          只看末尾N行          |
|  od  |  以二进制的方式读取文件内容   |



##### 直接查看文件内容 -- cat、tac、nl

*   cat */dir/file*：查看文件内容
*   cat -n */dir/file*：查看文件内容，并显示行号
*   nl命令可以将行号做更多的显示设计，详见help



##### 可翻页查看 -- more、less

more的命令模式

|       命令       |           功能           |
| :--------------: | :----------------------: |
| <kbd>     </kbd> |        向下翻一页        |
| <kbd>Enter</kbd> |        向下翻一行        |
|     /string      | 从当前行查找string字符串 |
|   <kbd>n</kbd>   |    搜索时，查找下一个    |
|        :f        |   显示文件名和当前行号   |
|   <kbd>q</kbd>   |         退出more         |
|   <kbd>b</kbd>   |  往回翻页(只对文件有用)  |

less的命令模式

|              命令               |           功能           |
| :-----------------------------: | :----------------------: |
| <kbd>   </kbd>、<kbd>PgDn</kbd> |        向下翻一页        |
|  <kbd>b</kbd>、<kbd>PgUp</kbd>  |        向上翻一页        |
|             /string             |  向下查找*string*字符串  |
|             ?string             |  向上查找*string*字符串  |
|          <kbd>n</kbd>           | 查找模式下，继续执行查询 |
|          <kbd>N</kbd>           | 查找模式下，反向执行查询 |
|          <kbd>q</kbd>           |         退出less         |



##### 数据截取 -- head、tail

有时我们只需要查看某个文件头几行或者末尾几行的内容，可用head或tail命令，他们都是以行为单位来截取的。

命令：$ tail -200f /data/log/xxx.log

提取一个文件的11行到20行，思路：先提取前20行，再取后10行(管道操作)：

命令：$ head -n 20 /data/log/xxx.log | tail -n 10



##### 非文本文件 -- od

如果要查看非文本文件(二进制文件)，可能会产生乱码，可以用od命令来读取。

命令：od [-t *TYPE*] 文件

例如：$od -t c /usr/bin/passwd;    $od -t oCc /etc/issue

-t 选项后参数释义：

| 参数 |       功能        |
| :--: | :---------------: |
|  a   |  以默认字节输出   |
|  c   | 以ASCII字节码输出 |
|  d   |   以十进制输出    |
|  f   |  以浮点数值输出   |
|  o   |   以八进制输出    |
|  x   |  以十六进制输出   |



##### 修改文件时间或创建新文件 -- touch

Linux中，每个文件都会记录许多时间参数，主要有三种：

*   modification time：**文件内容**变更时间
*   status time：**文件状态**变更时间（比如权限与属性）
*   access time：**文件内容被读取**时间（例如用cat去读取某个文件内容）
*   默认情况下，ls显示出来的时间是mtime
*   ls --time=atime/ctime，可以显示出另外两种时间







### 文件与目录的默认权限与隐藏权限







### 命令与文件的搜寻







### 权限与命令的关系(极重要！)



## Linux磁盘与文件系统管理







## 文件的压缩与打包









# SHELL